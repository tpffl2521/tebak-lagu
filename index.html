<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tebak Lagu ‚Äî TREASURE & Stray Kids</title>
<style>
  :root{
    --bg: radial-gradient(1200px 800px at 10% 10%, #ffd166 0%, #f72585 40%, transparent 60%),
          radial-gradient(1000px 700px at 90% 0%, #4cc9f0 0%, transparent 55%),
          radial-gradient(900px 700px at 50% 100%, #80ed99 0%, transparent 60%),
          linear-gradient(135deg,#0d0b1e,#1a1034);
    --card:#ffffff;
    --ink:#1f2937;
    --muted:#6b7280;
    --accent:#7c3aed;
    --accent-2:#f43f5e;
    --good:#16a34a;
    --bad:#ef4444;
    --chip:#eef2ff;
    --btn:#111827;
    --btn-ink:#fff;
  }
  *{box-sizing:border-box}
  body{
    margin:0; color:#fff; min-height:100svh;
    background:var(--bg); background-attachment: fixed;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    display:grid; place-items:center; padding:16px;
  }
  .app{
    width:min(920px,100%); display:grid; gap:14px;
  }
  .header{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    flex-wrap:wrap;
  }
  .brand{display:flex; align-items:center; gap:10px}
  .logo{
    width:40px; height:40px; border-radius:12px;
    background: conic-gradient(from 30deg,#f59e0b,#ef4444,#8b5cf6,#22c55e,#06b6d4,#f59e0b);
    box-shadow:0 8px 30px #00000030;
  }
  h1{font-size:clamp(20px,4vw,28px); margin:0}
  .scorebar{
    display:flex; gap:10px; align-items:center; flex-wrap:wrap;
  }
  .pill{background:#00000030; padding:8px 12px; border-radius:999px; font-weight:600}
  .btn{
    border:0; border-radius:12px; padding:12px 16px; font-weight:700; cursor:pointer;
    background:var(--btn); color:var(--btn-ink); box-shadow:0 8px 20px #00000030;
    transition:transform .05s ease;
  }
  .btn:active{transform:translateY(1px)}
  .btn.secondary{background:#ffffff; color:#111827}
  .btn.ghost{background:#00000020; color:#fff}
  .card{
    background:var(--card); color:var(--ink); border-radius:18px; padding:16px;
    box-shadow:0 12px 40px #0000002a;
  }
  .row{display:flex; gap:12px; flex-wrap:wrap}
  .col{flex:1 1 260px}
  .section-title{
    font-weight:800; letter-spacing:.3px; color:#111827; margin:4px 0 10px
  }
  /* FILTERS */
  .filters{display:flex; gap:8px; flex-wrap:wrap}
  .chip{
    border:2px solid #0000; background:var(--chip); color:#3730a3;
    padding:8px 12px; border-radius:999px; font-weight:700; cursor:pointer;
  }
  .chip.active{ outline:3px solid #a78bfa; background:#ede9fe; }
  .hintbox{
    background:linear-gradient(135deg,#fef3c7,#fce7f3);
    border:2px dashed #f59e0b; border-radius:16px; padding:14px; margin:6px 0 12px;
  }
  .hint-type{font-size:13px; color:#92400e; font-weight:800; text-transform:uppercase; letter-spacing:.5px}
  .hint{font-size:clamp(18px,4.5vw,24px); margin-top:6px; line-height:1.3}
  /* OPTIONS */
  .options{display:grid; grid-template-columns:1fr; gap:10px}
  @media(min-width:560px){ .options{grid-template-columns:1fr 1fr} }
  .opt{
    background:#f8fafc; border:2px solid #e5e7eb; border-radius:14px; padding:12px;
    font-weight:700; cursor:pointer; text-align:left;
  }
  .opt.correct{border-color:var(--good); background:#ecfdf5}
  .opt.wrong{border-color:var(--bad); background:#fef2f2}
  .meta{display:flex; gap:8px; flex-wrap:wrap; color:var(--muted); font-size:13px}
  .progress{
    height:10px; background:#00000025; border-radius:999px; overflow:hidden
  }
  .progress > i{display:block; height:100%; width:0; background:linear-gradient(90deg,#22c55e,#f59e0b,#ef4444)}
  .footer{display:flex; gap:8px; flex-wrap:wrap; justify-content:space-between; align-items:center}
  .tiny{font-size:12px; color:#e5e7eb}
  .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#111827; color:#fff; padding:2px 6px; border-radius:6px; font-size:12px}
  .hidden{display:none !important}
</style>
</head>
<body>
  <div class="app" id="app">
    <div class="header">
      <div class="brand">
        <div class="logo"></div>
        <h1>Tebak Lagu ‚Äî TREASURE & Stray Kids</h1>
      </div>
      <div class="scorebar">
        <span class="pill">Skor: <b id="score">0</b></span>
        <span class="pill">Streak üî•: <b id="streak">0</b></span>
        <span class="pill">High Score: <b id="hiscore">0</b></span>
        <button class="btn ghost" id="resetHS" title="Reset High Score">Reset HS</button>
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div class="col">
          <div class="section-title">Pilih Grup</div>
          <div class="filters" id="groupFilters">
            <button class="chip active" data-group="ALL">Semua</button>
            <button class="chip" data-group="TREASURE">TREASURE</button>
            <button class="chip" data-group="Stray Kids">Stray Kids</button>
          </div>
          <div class="section-title" style="margin-top:12px">Pengaturan</div>
          <div class="filters">
            <button class="chip active" id="modeEmoji" title="Clue emoji">Emoji</button>
            <button class="chip active" id="modeYear" title="Clue tahun rilis">Tahun</button>
            <button class="chip active" id="modeFact" title="Clue fakta singkat">Fakta</button>
            <button class="chip" id="modeLyric" title="Potongan lirik ‚â§10 kata">Lirik</button>
          </div>
          <div class="filters" style="margin-top:8px">
            <button class="chip active" id="timerToggle">Timer: ON</button>
            <button class="chip" id="hardToggle">Hard: OFF</button>
          </div>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
            <button class="btn" id="startBtn">Mulai / Soal Berikutnya</button>
            <button class="btn secondary" id="fiftyBtn">üéØ 50:50</button>
            <button class="btn secondary" id="revealBtn">üí° Tampilkan Jawaban</button>
          </div>
          <p class="tiny">Tip: tekan <span class="kbd">1</span><span class="kbd">2</span><span class="kbd">3</span><span class="kbd">4</span> untuk memilih opsi.</p>
        </div>

        <div class="col">
          <div class="section-title">Clue</div>
          <div class="hintbox">
            <div class="hint-type" id="hintType">‚Äî</div>
            <div class="hint" id="hintText">Tekan ‚ÄúMulai‚Äù untuk memulai permainan.</div>
          </div>

          <div class="section-title">Pilihan Jawaban</div>
          <div class="options" id="options"></div>

          <div class="meta" style="margin-top:10px">
            <span>‚è±Ô∏è Waktu: <b id="timeLeft">‚Äî</b></span>
            <span>‚Ä¢</span>
            <span id="questionMeta">‚Äî</span>
          </div>
          <div class="progress" style="margin-top:8px">
            <i id="progressFill"></i>
          </div>

          <div class="footer" style="margin-top:12px">
            <span id="feedback" class="tiny">Selamat bermain!</span>
            <div style="display:flex; gap:8px">
              <button class="btn ghost" id="shareBtn">Bagikan Skor</button>
              <button class="btn ghost" id="againBtn">Ulangi</button>
            </div>
          </div>

        </div>
      </div>
    </div>

    <p class="tiny">Konten game ini menggunakan petunjuk non-audio. Untuk bermain dengan audio snippet, tambahkan file preview Anda sendiri.</p>
  </div>

<script>
/* ---------- DATA LAGU ---------- */
const SONGS = [
  // TREASURE
  {title:"BOY", group:"TREASURE", year:2020, emoji:"üßí‚ú®üöÄ", fact:"Debut single TREASURE.", lyric:"I‚Äôm your boy (whoa-oh)"},
  {title:"I LOVE YOU", group:"TREASURE", year:2020, emoji:"‚ù§Ô∏èüò≠üåä", fact:"Single kedua 2020.", lyric:"I love you, love you"},
  {title:"MMM", group:"TREASURE", year:2020, emoji:"ü§êüé∂üî•", fact:"Juga ditulis ‚ÄúMmmh‚Äù.", lyric:"Mmm, mmm‚Äîcan you feel"},
  {title:"JIKJIN", group:"TREASURE", year:2022, emoji:"üèéÔ∏èüí®üí•", fact:"Ikonik dengan konsep balap.", lyric:"Jikjin, run it, run it"},
  {title:"DARARI", group:"TREASURE", year:2022, emoji:"üéµüíûüåô", fact:"Viral di platform short.", lyric:"Darari, darari, da"},
  {title:"HELLO", group:"TREASURE", year:2022, emoji:"üëãüåàüéâ", fact:"Lagu ceria menyapa dunia.", lyric:"Hello, hello, hello"},

  // Stray Kids
  {title:"God‚Äôs Menu", group:"Stray Kids", year:2020, emoji:"üç≥üë®‚Äçüç≥üî•", fact:"‚ÄúDU DU DU DU‚Äù ikonik.", lyric:"Cookin‚Äô like a chef"},
  {title:"Back Door", group:"Stray Kids", year:2020, emoji:"üö™‚Ü©Ô∏èüéâ", fact:"‚ÄúYou wanna come in?‚Äù", lyric:"You wanna come in?"},
  {title:"Thunderous", group:"Stray Kids", year:2021, emoji:"‚ö°ü•Åüê≤", fact:"Bersuara lantang, trad-modern.", lyric:"Thunderous, loud loud"},
  {title:"MANIAC", group:"Stray Kids", year:2022, emoji:"üåÄüß†üí•", fact:"Hook ‚ÄúMANIAC‚Äù meledak.", lyric:"Maniac, going crazy"},
  {title:"CASE 143", group:"Stray Kids", year:2022, emoji:"üïµÔ∏è‚Äç‚ôÇÔ∏èüíó143", fact:"143 = I LOVE YOU.", lyric:"Case one-four-three"},
  {title:"S-Class", group:"Stray Kids", year:2023, emoji:"üèÜ‚≠êüö¶", fact:"Peraih Daesang 2023.", lyric:"It‚Äôs a S-Class vibe"},
];

/* ---------- STATE ---------- */
let pool = [...SONGS];
let current=null, options=[], allowAnswer=false, timer=null, totalTime=20, timeLeft=20;
let score=0, streak=0, qIndex=0, usedFifty=false;

/* ---------- UTIL ---------- */
const el = (id)=>document.getElementById(id);
const shuffle = (a)=>a.sort(()=>Math.random()-0.5);
const vibrate = (ms=35)=>{ try{ if(navigator.vibrate) navigator.vibrate(ms);}catch{} };
const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));
const sample = (arr, n)=>shuffle([...arr]).slice(0,n);
const hiscoreKey = "kpop_guess_hiscore_v1";

/* ---------- RENDER HELPERS ---------- */
function setHint(song, mode){
  let type="", text="";
  if(mode==="emoji"){ type="Emoji Hint"; text=song.emoji; }
  else if(mode==="year"){ type="Tahun Rilis"; text = `Dirilis tahun <b>${song.year}</b>.`; }
  else if(mode==="fact"){ type="Fakta Singkat"; text = song.fact; }
  else if(mode==="lyric"){ type="Potongan Lirik"; text = `<i>‚Äú${song.lyric}‚Äù</i>`; } // ‚â§10 kata
  el("hintType").textContent = type;
  el("hintText").innerHTML = text;
}

function renderOptions(correctTitle){
  const titles = SONGS.map(s=>s.title);
  const distractors = sample(titles.filter(t=>t!==correctTitle), 3);
  options = shuffle([correctTitle, ...distractors]);
  const cont = el("options");
  cont.innerHTML = "";
  options.forEach((t,i)=>{
    const btn = document.createElement("button");
    btn.className="opt";
    btn.dataset.index=i;
    btn.innerHTML = `<div style="display:flex; justify-content:space-between; align-items:center; gap:8px">
      <span>${t}</span>
      <span class="tiny" style="color:var(--muted)">(${i+1})</span>
    </div>`;
    btn.onclick = ()=>pick(i);
    cont.appendChild(btn);
  });
}

function renderMeta(){
  el("questionMeta").textContent = `${current.group} ‚Ä¢ ${qIndex+1}`;
}

/* ---------- TIMER ---------- */
function startTimer(){
  clearInterval(timer);
  timeLeft = totalTime;
  el("timeLeft").textContent = `${timeLeft}s`;
  fillProgress();
  timer = setInterval(()=>{
    timeLeft--;
    el("timeLeft").textContent = `${timeLeft}s`;
    fillProgress();
    if(timeLeft<=0){ clearInterval(timer); lock(false, "Waktu habis!"); }
  }, 1000);
}
function fillProgress(){
  const w = (timeLeft/totalTime)*100;
  el("progressFill").style.width = `${clamp(w,0,100)}%`;
}

/* ---------- GAME FLOW ---------- */
function nextQuestion(){
  allowAnswer=false; usedFifty=false;
  // Build pool per filter
  const groupSel = [...document.querySelectorAll('#groupFilters .chip')]
    .find(ch=>ch.classList.contains('active'))?.dataset.group || "ALL";
  let candidates = SONGS.filter(s=>{
    if(groupSel==="ALL") return true;
    return s.group===groupSel;
  });
  if(candidates.length<4) candidates = SONGS;

  current = sample(candidates,1)[0];
  qIndex++;
  // Mode
  const modes = [];
  if(el("modeEmoji").classList.contains("active")) modes.push("emoji");
  if(el("modeYear").classList.contains("active")) modes.push("year");
  if(el("modeFact").classList.contains("active")) modes.push("fact");
  if(el("modeLyric").classList.contains("active")) modes.push("lyric");
  const mode = modes.length ? sample(modes,1)[0] : "emoji";

  // Hard mode menambah opsi mirip (judul dari grup sama)
  let titlesPool = SONGS.map(s=>s.title);
  if(el("hardToggle").classList.contains("active")){
    titlesPool = SONGS.filter(s=>s.group===current.group).map(s=>s.title);
    if(titlesPool.length<4) titlesPool = SONGS.map(s=>s.title);
  }

  // Render
  setHint(current, mode);
  renderOptions(current.title);
  renderMeta();
  el("feedback").textContent = "Pilih jawaban yang benar.";
  allowAnswer=true;

  // Timer
  if(el("timerToggle").classList.contains("active")){
    totalTime = 20;
    startTimer();
  } else {
    el("timeLeft").textContent = "‚Äî";
    el("progressFill").style.width = "0%";
    clearInterval(timer);
  }
}

function pick(i){
  if(!allowAnswer) return;
  allowAnswer=false;
  clearInterval(timer);
  const correctIdx = options.indexOf(current.title);
  const nodes = [...document.querySelectorAll('.opt')];
  nodes.forEach(n=>n.disabled=true);

  if(i===correctIdx){
    nodes[i].classList.add("correct");
    score += 100 + (timeLeft*3);
    streak++; vibrate(30);
    el("feedback").textContent = `Benar! +${100 + (timeLeft*3)} ‚Ä¢ ${current.title} ‚Äî ${current.group}`;
  } else {
    nodes[i]?.classList.add("wrong");
    nodes[correctIdx]?.classList.add("correct");
    streak = 0; vibrate([25,50,25]);
    el("feedback").textContent = `Kurang tepat. Jawaban: ${current.title} ‚Äî ${current.group}`;
  }
  el("score").textContent = score;
  el("streak").textContent = streak;

  // High score
  const hs = Number(localStorage.getItem(hiscoreKey)||0);
  if(score>hs){ localStorage.setItem(hiscoreKey, String(score)); }

  // Auto lanjut setelah sedikit jeda
  setTimeout(()=>{ nextQuestion(); }, 900);
}

/* ---------- LIFELINES ---------- */
function useFifty(){
  if(!allowAnswer || usedFifty) return;
  usedFifty = true;
  const correctIdx = options.indexOf(current.title);
  const wrongIdx = options.map((t,i)=>({t,i})).filter(o=>o.i!==correctIdx);
  const removeTwo = sample(wrongIdx,2);
  removeTwo.forEach(o=>{
    const btn = document.querySelector(`.opt[data-index="${o.i}"]`);
    if(btn){ btn.disabled=true; btn.style.opacity=.6; }
  });
  vibrate(20);
}

/* ---------- SHARE ---------- */
function shareScore(){
  const hi = Number(localStorage.getItem(hiscoreKey)||0);
  const txt = `üéµ Tebak Lagu K-Pop ‚Äî TREASURE & Stray Kids\nSkor: ${score}\nStreak: ${streak}\nHigh Score: ${hi}\nCoba kalahkan skorku!`;
  if(navigator.share){
    navigator.share({title:"Tebak Lagu K-Pop", text:txt}).catch(()=>{});
  } else {
    navigator.clipboard.writeText(txt).then(()=>{
      alert("Teks skor disalin! Tempel di chat kamu.");
    });
  }
}

/* ---------- INIT UI ---------- */
function init(){
  // High score
  el("hiscore").textContent = localStorage.getItem(hiscoreKey)||0;

  // Filter toggles
  document.querySelectorAll('#groupFilters .chip').forEach(ch=>{
    ch.addEventListener('click', ()=>{
      document.querySelectorAll('#groupFilters .chip').forEach(x=>x.classList.remove('active'));
      ch.classList.add('active');
    });
  });

  // Mode toggles
  ["modeEmoji","modeYear","modeFact","modeLyric"].forEach(id=>{
    el(id).addEventListener('click', e=> e.currentTarget.classList.toggle('active'));
  });

  // Settings
  el("timerToggle").addEventListener('click', e=>{
    e.currentTarget.classList.toggle('active');
    e.currentTarget.textContent = e.currentTarget.classList.contains('active') ? "Timer: ON" : "Timer: OFF";
  });
  el("hardToggle").addEventListener('click', e=>{
    e.currentTarget.classList.toggle('active');
    e.currentTarget.textContent = e.currentTarget.classList.contains('active') ? "Hard: ON" : "Hard: OFF";
  });

  // Buttons
  el("startBtn").addEventListener('click', nextQuestion);
  el("againBtn").addEventListener('click', ()=>{
    score=0; streak=0; qIndex=0; usedFifty=false;
    el("score").textContent = 0; el("streak").textContent = 0;
    nextQuestion();
  });
  el("fiftyBtn").addEventListener('click', useFifty);
  el("revealBtn").addEventListener('click', ()=>{
    if(!current) return;
    const idx = options.indexOf(current.title);
    pick(idx);
  });
  el("shareBtn").addEventListener('click', shareScore);
  el("resetHS").addEventListener('click', ()=>{
    localStorage.setItem(hiscoreKey,"0");
    el("hiscore").textContent = "0";
  });

  // Keyboard (1-4)
  window.addEventListener('keydown', (e)=>{
    const map={"1":0,"2":1,"3":2,"4":3};
    if(map[e.key]!==undefined){
      const btn=document.querySelector(`.opt[data-index="${map[e.key]}"]`);
      if(btn && !btn.disabled) pick(map[e.key]);
    }
  });
}

init();
</script>
</body>
</html>
